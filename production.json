{     "SqlCommand": "SET @FromDate = '{value1}', @ToDate  = '{value2}'; 
SELECT COALESCE(SUM(
COALESCE(provinfo.GrossProd, 0)
+ COALESCE(provinfo.Adjust, 0)
- COALESCE(provinfo.WOEstimate, 0)
- COALESCE(provinfo.WOAdjustment, 0)
),0) AS DayProductionResult
FROM (
SELECT pr.Abbr,
(
SELECT SUM(TIME_TO_SEC(IF(cev.TimeDisplayed2 != '01-01-0001', TIMEDIFF(cev.TimeDisplayed2,cev.TimeDisplayed1),0)))/3600 AS 'Hours'
FROM clockevent cev
INNER JOIN employee emp
ON emp.EmployeeNum = cev.EmployeeNum
INNER JOIN userod
ON userod.EmployeeNum = emp.EmployeeNum
WHERE cev.TimeDisplayed1 BETWEEN @FromDate AND @ToDate + INTERVAL 1 DAY -- Date limitation
AND cev.TimeDisplayed2 BETWEEN @FromDate AND @ToDate + INTERVAL 1 DAY -- Date limitation
AND userod.ProvNum = pr.ProvNum GROUP BY pr.ProvNum) AS Hours,
(
SELECT SUM(pl.ProcFee * (pl.UnitQty + pl.BaseUnits))
FROM procedurelog pl
WHERE pl.ProvNum = pr.ProvNum
AND pl.ProcDate BETWEEN @FromDate AND @ToDate -- Date limitation
AND pl.ProcStatus = 2 -- Completed procedures
) GrossProd,
(
SELECT SUM(adj.AdjAmt)
FROM adjustment adj
WHERE adj.ProvNum = pr.ProvNum
AND adj.AdjDate BETWEEN @FromDate AND @ToDate
) AS Adjust,
(
SELECT SUM(css.Writeoff)
FROM claimsnapshot css
INNER JOIN claimproc cp
ON cp.ClaimProcNum = css.ClaimProcNum
WHERE css.DateTEntry BETWEEN @FromDate AND @ToDate + INTERVAL 1 DAY
AND cp.ProvNUm = pr.ProvNum
) AS WOEstimate,
(
SELECT SUM(cp.Writeoff - COALESCE(css.Writeoff, 0))
FROM claimproc cp
LEFT JOIN claimsnapshot css
ON css.ClaimProcNum = cp.ClaimProcNum
WHERE cp.DateCP BETWEEN @FromDate AND @ToDate -- Date limitation
AND cp.Status IN (1,4) -- Received, Supplemental
AND cp.ProvNum = pr.ProvNum
) WOAdjustment
FROM provider pr
WHERE !(pr.IsHidden) -- All non-hidden providers
GROUP BY pr.ProvNum
) provinfo
WHERE (Hours != 0 OR ABS(GrossProd) >= 0.005 OR ABS(Adjust) >= 0.005 OR ABS(WOEstimate) >= 0.005 or abs(WOAdjustment) >= 0.005)
" }